# Challenge Description
Category: Web Exploitation Problem: The challenge website presents different content based on a value stored in a browser cookie. The objective is to discover the specific cookie value that causes the server to return the flag.

## Solution 
This challenge involves manipulating client-side data to alter the server's response. The attack vector is the HTTP Cookie header, which the user can control.

Initial Page Inspection: The challenge link leads to a simple web page. It displays a welcome message and a text box, but the primary functionality seems to be displaying different "cookie" (biscuit) names.

Cookie Discovery: Using the browser's Developer Tools (F12) and navigating to the Application tab (in Chrome/Edge) or Storage tab (in Firefox), we can inspect the cookies set for the challenge domain. A cookie named name is found, and its value is a simple integer (e.g., 0 or 1).

Manual Cookie Manipulation (Enumeration): The page's content appears to be directly related to this name cookie's value. The core of the challenge is to test different values.

By double-clicking the cookie's value in the Developer Tools, it becomes editable.

Change the value from 0 to 1 and refresh the page. The message on the page changes (e.g., from "Chocolate Chip" to "Snickerdoodle").

This confirms the server is reading this cookie and using its value to determine what to display.

Iterative Testing: We continue this manual process, incrementing the integer value one by one and refreshing the page:

name=2

name=3

...

name=18 After testing a small range of numbers, one specific value (e.g., 18, though this can vary) causes the server to respond with the flag instead of a cookie name.

Flag Retrieval: The flag is rendered directly onto the web page.

## Flag
```
picoCTF{3v3ry1_l0v3s_c00k135_064663be}
```
## Concepts Learnt
HTTP Cookie Mechanism: Cookies are key-value pairs sent by a server (via the Set-Cookie header) and stored by the browser. The browser then sends this data back to the server with every subsequent request (via the Cookie header). This is the primary mechanism for maintaining state (like a session) over the stateless HTTP protocol.

Client-Side Data Tampering: Any data stored on the client (in cookies, localStorage, sessionStorage, or hidden form fields) is insecure and cannot be trusted by the server. A user has full control over this data and can intercept, read, and modify it at will. This challenge is a fundamental demonstration of this principle.

Insecure Direct Object Reference (IDOR) / Broken Access Control: This vulnerability is a simple form of IDOR. The cookie value is effectively an "ID" for a piece of content. The server insecurely trusts the ID provided by the client without first verifying that the client is authorized to access the content associated with that ID.

Enumeration Attack: The solution method is a simple enumeration attack. We are systematically iterating through a predictable and small set of values (integers 0, 1, 2, ...) to discover a hidden endpoint or piece of data.

## Notes
Common Pitfall: A common first instinct is to check the page's HTML source (Ctrl+U) for the flag. This challenge is designed to show that many vulnerabilities are not static but dynamic, requiring interaction with the application to reveal the flag.

Essential Tooling: Proficiency with browser Developer Tools is mandatory for web exploitation. The Application/Storage tab (for cookies/local storage) and the Network tab (for inspecting headers) are critical.

Automation (Alternative Approach): If the required cookie value had been 1800 instead of 18, manual testing would be impossible. This attack is trivial to script. A Python script using the requests library could loop through hundreds of values in seconds.

You would use a requests.Session() object to manage the connection.

Inside a for loop, you would set the cookie value for the request: cookies = {'name': str(i)}.

You would then make the request: r = s.get(url, cookies=cookies).

Finally, you would check the response text for the flag format: if "picoCTF{" in r.text: ...

## Resources
1. https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies

2. https://owasp.org/www-project-top-ten/2021/A01_2021-Broken_Access_Control

3. https://portswigger.net/web-security/sessions/cookie-manipulation

4. https://requests.readthedocs.io/en/latest/user/advanced/#session-objects
